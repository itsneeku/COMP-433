True
Args in experiment:
Basic Config
  Task Name:          long_term_forecast  Is Training:        1
  Model ID:           temp                Model:              RAFT

Data Loader
  Data:               ETTm1               Root Path:          ./data/ETT/
  Data Path:          ETTm1.csv           Features:           M
  Target:             OT                  Freq:               h
  Checkpoints:        ./checkpoints/

Forecasting Task
  Seq Len:            96                  Label Len:          48
  Pred Len:           96                  Seasonal Patterns:  Monthly
  Inverse:            0

Model Parameters
  Top k:              5                   Num Kernels:        6
  Enc In:             7                   Dec In:             7
  C Out:              7                   d model:            512
  n heads:            8                   e layers:           2
  d layers:           1                   d FF:               2048
  Moving Avg:         25                  Factor:             1
  Distil:             1                   Dropout:            0.1
  Embed:              timeF               Activation:         gelu
  Output Attention:   0

Run Parameters
  Num Workers:        10                  Itr:                1
  Train Epochs:       10                  Batch Size:         32
  Patience:           10                  Learning Rate:      0.0001
  Des:                test                Loss:               MSE
  Lradj:              type1               Use Amp:            0

GPU
  Use GPU:            1                   GPU:                0
  Use Multi GPU:      0                   Devices:            0,1,2,3

De-stationary Projector Params
  P Hidden Dims:      128, 128            P Hidden Layers:    2

Use GPU: cuda:0
train 34369
val 11425
test 11425
Doing Train Retrieval
100%|████████████████████████████████████████████████████████████████████████████| 34/34 [00:28<00:00,  1.19it/s]
Doing Valid Retrieval
100%|████████████████████████████████████████████████████████████████████████████| 12/12 [00:09<00:00,  1.33it/s]
Doing Test Retrieval
100%|████████████████████████████████████████████████████████████████████████████| 12/12 [00:08<00:00,  1.34it/s]
>>>>>>>start training : long_term_forecast_temp_RAFT_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
        iters: 100, epoch: 1 | loss: 0.4193639
        speed: 0.0398s/iter; left time: 423.7897s
        iters: 200, epoch: 1 | loss: 0.2802038
        speed: 0.0298s/iter; left time: 314.4363s
        iters: 300, epoch: 1 | loss: 0.2663001
        speed: 0.0289s/iter; left time: 301.9942s
        iters: 400, epoch: 1 | loss: 0.2134381
        speed: 0.0292s/iter; left time: 302.4134s
        iters: 500, epoch: 1 | loss: 0.2548821
        speed: 0.0291s/iter; left time: 298.4016s
        iters: 600, epoch: 1 | loss: 0.2953896
        speed: 0.0293s/iter; left time: 297.7738s
        iters: 700, epoch: 1 | loss: 0.2577026
        speed: 0.0302s/iter; left time: 303.9962s
        iters: 800, epoch: 1 | loss: 0.3417650
        speed: 0.0319s/iter; left time: 317.1856s
        iters: 900, epoch: 1 | loss: 0.2867412
        speed: 0.0308s/iter; left time: 303.5467s
        iters: 1000, epoch: 1 | loss: 0.3339564
        speed: 0.0338s/iter; left time: 329.2396s
Epoch: 1 cost time: 33.169854402542114
Epoch: 1, Steps: 1075 | Train Loss: 0.3156521 Vali Loss: 0.3924589 Test Loss: 0.4428377
Updating learning rate to 0.0001
        iters: 100, epoch: 2 | loss: 0.3304881
        speed: 0.1562s/iter; left time: 1495.3319s
        iters: 200, epoch: 2 | loss: 0.2568896
        speed: 0.0288s/iter; left time: 273.3525s
        iters: 300, epoch: 2 | loss: 0.2766471
        speed: 0.0278s/iter; left time: 260.4111s
        iters: 400, epoch: 2 | loss: 0.2697720
        speed: 0.0289s/iter; left time: 267.9753s
        iters: 500, epoch: 2 | loss: 0.2666329
        speed: 0.0299s/iter; left time: 274.5491s
        iters: 600, epoch: 2 | loss: 0.2525913
        speed: 0.0290s/iter; left time: 263.3629s
        iters: 700, epoch: 2 | loss: 0.2453283
        speed: 0.0284s/iter; left time: 254.5451s
        iters: 800, epoch: 2 | loss: 0.3400999
        speed: 0.0289s/iter; left time: 256.4725s
        iters: 900, epoch: 2 | loss: 0.2269741
        speed: 0.0294s/iter; left time: 257.6500s
        iters: 1000, epoch: 2 | loss: 0.2491920
        speed: 0.0286s/iter; left time: 248.3518s
Epoch: 2 cost time: 31.636122941970825
Epoch: 2, Steps: 1075 | Train Loss: 0.2722039 Vali Loss: 0.3950726 Test Loss: 0.4590289
Updating learning rate to 5e-05
        iters: 100, epoch: 3 | loss: 0.3767684
        speed: 0.1579s/iter; left time: 1342.7019s
        iters: 200, epoch: 3 | loss: 0.3008437
        speed: 0.0286s/iter; left time: 240.3969s
        iters: 300, epoch: 3 | loss: 0.2643081
        speed: 0.0293s/iter; left time: 243.0061s
        iters: 400, epoch: 3 | loss: 0.2291062
        speed: 0.0288s/iter; left time: 236.2813s
        iters: 500, epoch: 3 | loss: 0.2374355
        speed: 0.0289s/iter; left time: 234.4153s
        iters: 600, epoch: 3 | loss: 0.2583836
        speed: 0.0304s/iter; left time: 243.5424s
        iters: 700, epoch: 3 | loss: 0.2624041
        speed: 0.0297s/iter; left time: 234.8055s
        iters: 800, epoch: 3 | loss: 0.2314176
        speed: 0.0308s/iter; left time: 239.9656s
        iters: 900, epoch: 3 | loss: 0.2915036
        speed: 0.0295s/iter; left time: 227.1688s
        iters: 1000, epoch: 3 | loss: 0.2624062
        speed: 0.0295s/iter; left time: 223.9579s
Epoch: 3 cost time: 32.083104610443115
Epoch: 3, Steps: 1075 | Train Loss: 0.2680183 Vali Loss: 0.3902792 Test Loss: 0.4629708
Updating learning rate to 2.5e-05
        iters: 100, epoch: 4 | loss: 0.2263681
        speed: 0.1548s/iter; left time: 1149.9061s
        iters: 200, epoch: 4 | loss: 0.2887509
        speed: 0.0288s/iter; left time: 211.0128s
        iters: 300, epoch: 4 | loss: 0.2621340
        speed: 0.0292s/iter; left time: 210.8073s
        iters: 400, epoch: 4 | loss: 0.2468713
        speed: 0.0289s/iter; left time: 205.7862s
        iters: 500, epoch: 4 | loss: 0.2237853
        speed: 0.0292s/iter; left time: 205.3038s
        iters: 600, epoch: 4 | loss: 0.2215483
        speed: 0.0310s/iter; left time: 214.5071s
        iters: 700, epoch: 4 | loss: 0.2340904
        speed: 0.0300s/iter; left time: 205.0536s
        iters: 800, epoch: 4 | loss: 0.2932773
        speed: 0.0296s/iter; left time: 198.8427s
        iters: 900, epoch: 4 | loss: 0.3019760
        speed: 0.0292s/iter; left time: 193.7673s
        iters: 1000, epoch: 4 | loss: 0.2267291
        speed: 0.0310s/iter; left time: 202.0732s
Epoch: 4 cost time: 32.261752128601074
Epoch: 4, Steps: 1075 | Train Loss: 0.2666771 Vali Loss: 0.3871488 Test Loss: 0.4630237
Updating learning rate to 1.25e-05
        iters: 100, epoch: 5 | loss: 0.2721409
        speed: 0.1635s/iter; left time: 1038.4780s
        iters: 200, epoch: 5 | loss: 0.3488615
        speed: 0.0297s/iter; left time: 185.4799s
        iters: 300, epoch: 5 | loss: 0.2656553
        speed: 0.0321s/iter; left time: 197.2831s
        iters: 400, epoch: 5 | loss: 0.3355175
        speed: 0.0298s/iter; left time: 180.5140s
        iters: 500, epoch: 5 | loss: 0.2222005
        speed: 0.0298s/iter; left time: 177.2784s
        iters: 600, epoch: 5 | loss: 0.2368706
        speed: 0.0290s/iter; left time: 169.5048s
        iters: 700, epoch: 5 | loss: 0.2559413
        speed: 0.0288s/iter; left time: 165.8290s
        iters: 800, epoch: 5 | loss: 0.3053533
        speed: 0.0295s/iter; left time: 166.4740s
        iters: 900, epoch: 5 | loss: 0.2741936
        speed: 0.0288s/iter; left time: 159.6328s
        iters: 1000, epoch: 5 | loss: 0.2499956
        speed: 0.0295s/iter; left time: 161.0122s
Epoch: 5 cost time: 32.0973744392395
Epoch: 5, Steps: 1075 | Train Loss: 0.2664757 Vali Loss: 0.3878258 Test Loss: 0.4674719
Updating learning rate to 6.25e-06
        iters: 100, epoch: 6 | loss: 0.2373431
        speed: 0.1544s/iter; left time: 814.6285s
        iters: 200, epoch: 6 | loss: 0.2844191
        speed: 0.0290s/iter; left time: 150.0728s
        iters: 300, epoch: 6 | loss: 0.2026555
        speed: 0.0280s/iter; left time: 142.1953s
        iters: 400, epoch: 6 | loss: 0.2250465
        speed: 0.0309s/iter; left time: 153.5273s
        iters: 500, epoch: 6 | loss: 0.2670724
        speed: 0.0308s/iter; left time: 150.0849s
        iters: 600, epoch: 6 | loss: 0.2525507
        speed: 0.0287s/iter; left time: 136.9007s
        iters: 700, epoch: 6 | loss: 0.3594222
        speed: 0.0280s/iter; left time: 131.1140s
        iters: 800, epoch: 6 | loss: 0.3004728
        speed: 0.0291s/iter; left time: 133.3007s
        iters: 900, epoch: 6 | loss: 0.2358183
        speed: 0.0288s/iter; left time: 129.0374s
        iters: 1000, epoch: 6 | loss: 0.2153101
        speed: 0.0290s/iter; left time: 126.9031s
Epoch: 6 cost time: 31.565801858901978
Epoch: 6, Steps: 1075 | Train Loss: 0.2660233 Vali Loss: 0.3878779 Test Loss: 0.4657251
Updating learning rate to 3.125e-06
        iters: 100, epoch: 7 | loss: 0.3007075
        speed: 0.1515s/iter; left time: 636.5892s
        iters: 200, epoch: 7 | loss: 0.2873347
        speed: 0.0315s/iter; left time: 129.0383s
        iters: 300, epoch: 7 | loss: 0.2469361
        speed: 0.0357s/iter; left time: 142.7287s
        iters: 400, epoch: 7 | loss: 0.2908076
        speed: 0.0347s/iter; left time: 135.3010s
        iters: 500, epoch: 7 | loss: 0.3197129
        speed: 0.0338s/iter; left time: 128.5085s
        iters: 600, epoch: 7 | loss: 0.3059562
        speed: 0.0340s/iter; left time: 125.6715s
        iters: 700, epoch: 7 | loss: 0.3542778
        speed: 0.0356s/iter; left time: 128.2310s
        iters: 800, epoch: 7 | loss: 0.3060318
        speed: 0.0348s/iter; left time: 121.7967s
        iters: 900, epoch: 7 | loss: 0.2915213
        speed: 0.0295s/iter; left time: 100.3220s
        iters: 1000, epoch: 7 | loss: 0.2271715
        speed: 0.0302s/iter; left time: 99.7492s
Epoch: 7 cost time: 35.645124435424805
Epoch: 7, Steps: 1075 | Train Loss: 0.2658004 Vali Loss: 0.3875876 Test Loss: 0.4671641
Updating learning rate to 1.5625e-06
        iters: 100, epoch: 8 | loss: 0.2306545
        speed: 0.1521s/iter; left time: 475.3332s
        iters: 200, epoch: 8 | loss: 0.3037305
        speed: 0.0287s/iter; left time: 86.7990s
        iters: 300, epoch: 8 | loss: 0.2631617
        speed: 0.0282s/iter; left time: 82.6065s
        iters: 400, epoch: 8 | loss: 0.2432198
        speed: 0.0288s/iter; left time: 81.3735s
        iters: 500, epoch: 8 | loss: 0.2370281
        speed: 0.0287s/iter; left time: 78.2566s
        iters: 600, epoch: 8 | loss: 0.2286328
        speed: 0.0328s/iter; left time: 86.1969s
        iters: 700, epoch: 8 | loss: 0.3012834
        speed: 0.0322s/iter; left time: 81.3845s
        iters: 800, epoch: 8 | loss: 0.2799726
        speed: 0.0321s/iter; left time: 77.9431s
        iters: 900, epoch: 8 | loss: 0.2311773
        speed: 0.0320s/iter; left time: 74.4450s
        iters: 1000, epoch: 8 | loss: 0.2277393
        speed: 0.0315s/iter; left time: 70.1905s
Epoch: 8 cost time: 33.14777398109436
Epoch: 8, Steps: 1075 | Train Loss: 0.2660511 Vali Loss: 0.3892138 Test Loss: 0.4671412
Updating learning rate to 7.8125e-07
        iters: 100, epoch: 9 | loss: 0.2477330
        speed: 0.1739s/iter; left time: 356.6196s
        iters: 200, epoch: 9 | loss: 0.1944636
        speed: 0.0334s/iter; left time: 65.2311s
        iters: 300, epoch: 9 | loss: 0.2615094
        speed: 0.0318s/iter; left time: 58.7902s
        iters: 400, epoch: 9 | loss: 0.2986997
        speed: 0.0307s/iter; left time: 53.6899s
        iters: 500, epoch: 9 | loss: 0.2375854
        speed: 0.0305s/iter; left time: 50.4376s
        iters: 600, epoch: 9 | loss: 0.2497582
        speed: 0.0305s/iter; left time: 47.3283s
        iters: 700, epoch: 9 | loss: 0.2493232
        speed: 0.0303s/iter; left time: 43.9226s
        iters: 800, epoch: 9 | loss: 0.2447369
        speed: 0.0279s/iter; left time: 37.7227s
        iters: 900, epoch: 9 | loss: 0.2682628
        speed: 0.0278s/iter; left time: 34.7414s
        iters: 1000, epoch: 9 | loss: 0.2638203
        speed: 0.0277s/iter; left time: 31.8889s
Epoch: 9 cost time: 32.913127422332764
Epoch: 9, Steps: 1075 | Train Loss: 0.2658128 Vali Loss: 0.3882372 Test Loss: 0.4671253
Updating learning rate to 3.90625e-07
        iters: 100, epoch: 10 | loss: 0.2737191
        speed: 0.1491s/iter; left time: 145.5106s
        iters: 200, epoch: 10 | loss: 0.2444419
        speed: 0.0316s/iter; left time: 27.6685s
        iters: 300, epoch: 10 | loss: 0.1929527
        speed: 0.0307s/iter; left time: 23.8539s
        iters: 400, epoch: 10 | loss: 0.2590031
        speed: 0.0286s/iter; left time: 19.3330s
        iters: 500, epoch: 10 | loss: 0.2848797
        speed: 0.0285s/iter; left time: 16.4193s
        iters: 600, epoch: 10 | loss: 0.2872858
        speed: 0.0286s/iter; left time: 13.6083s
        iters: 700, epoch: 10 | loss: 0.2821507
        speed: 0.0318s/iter; left time: 11.9496s
        iters: 800, epoch: 10 | loss: 0.2392113
        speed: 0.0292s/iter; left time: 8.0700s
        iters: 900, epoch: 10 | loss: 0.2453901
        speed: 0.0310s/iter; left time: 5.4536s
        iters: 1000, epoch: 10 | loss: 0.2520148
        speed: 0.0323s/iter; left time: 2.4579s
Epoch: 10 cost time: 32.96840953826904
Epoch: 10, Steps: 1075 | Train Loss: 0.2658788 Vali Loss: 0.3877727 Test Loss: 0.4672073
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_temp_RAFT_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.32903918623924255, mae:0.3714752793312073, dtw:-999